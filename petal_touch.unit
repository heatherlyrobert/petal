#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include public header                petal.h                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (TOUCH) verify openning and closing touch event file               0s   file            TOUCH__open, TOUCH__close                                                    ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        PROG_unit_quiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char     *x_name  = "/tmp/event_test.txt";                                                                                                                                                                                 
     local    create working variable              - - - - - - - - - - - - -   FILE     *f       = NULL;                                                                                                                                                                                                  

   COND       attempt to open non-existant file                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     call open                            TOUCH__open                 x_name         , 'r'      , &f                                                                        i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       attempt to close a non-open file                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           TOUCH__close                &f                                                                                                    i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       attempt to open valid file with no pointer                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     create file                          yURG_touch                  x_name                                             , "root"    , "root"       , "0600"                i_equal     0                                                                                                    
     exec     call open                            TOUCH__open                 x_name         , 'r'      , NULL                                                                      i_lesser    0                                                                                                    

   COND       verify openning valid file                                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            TOUCH__open                 x_name         , 'r'      , &f                                                                        i_equal     0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_exists    0                                                                                                    

   COND       attempt to re-open file                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            TOUCH__open                 x_name         , 'r'      , &f                                                                        i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_exists    0                                                                                                    

   COND       attempt to close with a NULL                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           TOUCH__close                NULL                                                                                                  i_lesser    0                                                                                                    

   COND       verify closing file                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           TOUCH__close                &f                                                                                                    i_equal     0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       attempt to close a non-open file                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           TOUCH__close                &f                                                                                                    i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   f                                                                                                     p_null      0                                                                                                    

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     stop testing                         PROG_unit_end                                                                                                                     i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (TOUCH) verify finding event types                                 0s   ev_type         TOUCH__event_type                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        PROG_unit_quiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char      x_track = '-';                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char      x_desc  [LEN_LABEL] = "";                                                                                                                                                                                        

   COND       verify a quick success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     find event type                      TOUCH__event_type           0           , &x_track    , x_desc                                                                    i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂSYN   Ê                                                                                             

   COND       attempt an illegal event type                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     find event type                      TOUCH__event_type           -1          , &x_track    , x_desc                                                                    i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     '∑'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂÊ                                                                                                   

   COND       verify another good value                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     find event type                      TOUCH__event_type           3           , &x_track    , x_desc                                                                    i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂABS   Ê                                                                                             

   COND       verify other good values (plus defenses)                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     find event type                      TOUCH__event_type           1           , NULL        , x_desc                                                                    i_equal     1                                                                                                    
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂDEP   Ê                                                                                             
     exec     find event type                      TOUCH__event_type           2           , &x_track    , NULL                                                                      i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     exec     find event type                      TOUCH__event_type           4           , &x_track    , x_desc                                                                    i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂBTN   Ê                                                                                             

   COND       attempt a missing event type                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     find event type                      TOUCH__event_type           5           , &x_track    , x_desc                                                                    i_equal     0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     Â-?-   Ê                                                                                             

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         PROG_unit_end                                                                                                                     i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (TOUCH) verify finding event codes                                 0s   ev_code         TOUCH__event_code                                                            ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        PROG_unit_quiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char      x_track = '-';                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char      x_desc  [LEN_LABEL] = "";                                                                                                                                                                                        

   COND       verify a quick success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     local    set tracking                         - - - - - - - - - - - - -   x_track = 'y';                                                                                                                                                                                                             
     exec     find event type                      TOUCH__event_code           0           , 0           , &x_track    , x_desc                                                      i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     Âall     Ê                                                                                             

   COND       attempt an illegal code                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     local    set tracking                         - - - - - - - - - - - - -   x_track = 'y';                                                                                                                                                                                                             
     exec     find event type                      TOUCH__event_code           0           , -1          , &x_track    , x_desc                                                      i_lesser    0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     ÂÊ                                                                                                     

   COND       verify another good value                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     local    set tracking                         - - - - - - - - - - - - -   x_track = 'y';                                                                                                                                                                                                             
     exec     find event type                      TOUCH__event_code           3           , 0x04        , &x_track    , x_desc                                                      i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     Âbutton  Ê                                                                                             

   COND       verify other good values (plus defenses)                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     local    set tracking                         - - - - - - - - - - - - -   x_track = 'y';                                                                                                                                                                                                             
     exec     find event type                      TOUCH__event_code           3           , 0x00        , NULL        , x_desc                                                      i_equal     1                                                                                                    
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     Âabs_x   Ê                                                                                             
     exec     find event type                      TOUCH__event_code           3           , 0x01        , &x_track    , NULL                                                        i_equal     1                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  

   COND       verify missing event code                                          - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     local    set tracking                         - - - - - - - - - - - - -   x_track = 'y';                                                                                                                                                                                                             
     exec     find event type                      TOUCH__event_code           3           , 0x99        , &x_track    , x_desc                                                      i_equal     0                                                                                                    
     echo     ... check tracking                   - - - - - - - - - - - - -   x_track                                                                                               i_equal     'y'                                                                                                  
     echo     ... check description                - - - - - - - - - - - - -   x_desc                                                                                                w_equal     Â--?--   Ê                                                                                              

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         PROG_unit_end                                                                                                                     i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (TOUCH) verify reading single events                               0s   single          TOUCH__single                                                                ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       initialize the testing environment                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     start testing                        PROG_unit_quiet                                                                                                                   i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char     *x_name  = "/tmp/event_test.txt";                                                                                                                                                                                 
     local    create working variable              - - - - - - - - - - - - -   FILE     *f       = NULL;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   int       x_type  =   -1;                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   int       x_code  =   -1;                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   int       x_value =   -1;                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char      x_track =  '-';                                                                                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char      x_out   [LEN_FULL]  = "";                                                                                                                                                                                         

   COND       verify a quick success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     force data                           TOUCH_force_data            x_name      , 0x03        , 0x01        , 15                                                          i_equal     0                                                                                                    
     exec     call open                            TOUCH__open                 x_name         , 'r'      , &f                                                                        i_equal     0                                                                                                    
     exec     find event type                      TOUCH__single               f           , &x_type     , &x_code     , &x_value    , &x_track    , x_out                           i_equal     0                                                                                                    
     exec     call close                           TOUCH__close                &f                                                                                                    i_equal     0                                                                                                    
     echo     ... check output                     - - - - - - - - - - - - -   x_out                                                                                                 w_equal     Â00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   03 00 ABS   01 00 abs_y   0f 00 00 00         15Ê 

   COND       verify a quick success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     force data                           TOUCH_force_data            x_name      , 0x03        , 0x18        , 3000                                                        i_equal     0                                                                                                    
     exec     call open                            TOUCH__open                 x_name         , 'r'      , &f                                                                        i_equal     0                                                                                                    
     exec     find event type                      TOUCH__single               f           , &x_type     , &x_code     , &x_value    , &x_track    , x_out                           i_equal     0                                                                                                    
     exec     call close                           TOUCH__close                &f                                                                                                    i_equal     0                                                                                                    
     echo     ... check output                     - - - - - - - - - - - - -   x_out                                                                                                 w_equal     Â00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   03 00 ABS   18 00 hardnes b8 0b 00 00       3000Ê 

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     remove file                          yURG_rm                     x_name                                                                                                i_equal     0                                                                                                    
     exec     stop testing                         PROG_unit_end                                                                                                                     i_equal     0                                                                                                    



# end-of-file.  done, finito, completare, whimper [œ¥∑∑∑
